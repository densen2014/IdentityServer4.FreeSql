@using System.Diagnostics

@{
    Layout = null;
    var version = FileVersionInfo.GetVersionInfo(typeof(IdentityServer4.Hosting.IdentityServerMiddleware).Assembly.Location).ProductVersion.Split('+').First();
}

<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>IdentityServer4统一认证中心</title>
    <link rel="icon" href="favicon.ico" type="image/ico">
    <meta name="keywords" content="IdentityServer4,C#,.Net Core,.net5,猿米科技,oncemi">
    <meta name="description" content="由猿米科技基于FreeSql打造的IdentityServer4统一认证中心。">
    <meta name="author" content="oncemi">
    <link href="~/lib/light/css/bootstrap.min.css" rel="stylesheet">
    <link href="~/lib/light/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="~/lib/light/css/animate.min.css" rel="stylesheet">
    <link href="~/lib/light/css/style.min.css" rel="stylesheet">
</head>

<body>
    <div class="container-fluid p-t-15">

        @if (User?.Identity.IsAuthenticated == true)
        {

        }

        <div class="alert alert-info" role="alert">
            欢迎使用IdentityServer4，版本：@version
        </div>
        <div class="row">
            <div class="col-md-6 col-lg-4">
                <div class="card card-bordered">
                    <header class="card-header">
                        <div class="card-title">登录</div>
                    </header>
                    <div class="callout callout-success">用你的账号登录授权中心。</div>
                    <div class="card-body">
                        @if (User?.Identity.IsAuthenticated == true)
                        {
                            <a class="btn btn-warning btn-w-lg" href="~/account/logout">退出@(string.IsNullOrEmpty(User?.Identity.Name) ? "" : $"({User?.Identity.Name})")</a>
                        }
                        else
                        {
                            <a class="btn btn-success btn-w-lg" href="~/account/login">登录</a>
                        }

                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4">
                <div class="card card-shadowed">
                    <header class="card-header">
                        <div class="card-title">授权</div>
                    </header>

                    <div class="callout callout-success">查看你的授权的应用和网站等。</div>
                    <div class="card-body">
                        <a class="btn btn-info btn-w-lg" href="~/grants">授权</a>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4">
                <div class="card card-hover-shadow">
                    <header class="card-header">
                        <div class="card-title">发现文档</div>
                    </header>
                    <div class="callout callout-info">查看认证服务器的终端节点等信息。</div>
                    <div class="card-body">
                        <a class="btn btn-secondary btn-w-lg" href="~/.well-known/openid-configuration" target="_blank">发现文档</a>
                    </div>
                </div>
            </div>
        </div>
        <!-- .row -->
    </div>

    <script type="text/javascript" src="~/lib/light/js/jquery.min.js"></script>
    <script type="text/javascript" src="~/lib/light/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="~/lib/light/js/perfect-scrollbar.min.js"></script>
    <script type="text/javascript" src="~/lib/light/js/popper.min.js"></script>
    <script type="text/javascript" src="~/lib/light/js/bootstrap-notify.min.js"></script>
    <script type="text/javascript" src="~/lib/light/js/main.min.js"></script>
    <script>
        showCookieTip();

        function showCookieTip() {
            $.notify({
                message: '为确保您在我们的网站上获得最佳体验，本网站将会使用Cookie让您保持登录状态。',
            }, {
                type: "success",
                allow_dismiss: true,
                placement: {
                    from: "bottom",
                    align: "right"
                },
                offset: 0,
                spacing: 10,
                delay: 0,
                animate: {
                    enter: '',
                    exit: 'animated fadeOutDown'
                },
                template: '<div data-notify="container" class="col-xs-12 col-sm-12 col-md-12 col-lg-12 alert alert-{0}" role="alert">' +
                    '<button type="button" aria-hidden="true" class="close" data-notify="dismiss">×</button>' +
                    '<span data-notify="icon"></span> ' +
                    '<span data-notify="title">{1}</span> ' +
                    '<span data-notify="message">{2}</span>' +
                    '<div class="progress" data-notify="progressbar">' +
                    '<div class="progress-bar progress-bar-{0}" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div>' +
                    '</div>' +
                    '<a href="{3}" target="{4}" data-notify="url"></a>' +
                    '</div>',
            });
        }
    </script>
</body>
</html>
